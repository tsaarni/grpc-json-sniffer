<!doctype html>
<html lang="en">

    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="stylesheet" href="grpc-viewer.css" />
        <script type="module">
            import { GrpcViewer } from './grpc-viewer.js';
            document.addEventListener('DOMContentLoaded', () => {
                // eslint-disable-next-line no-unused-vars
                const _app = new GrpcViewer();
            });
        </script>
        <title>gRPC Viewer</title>
    </head>

    <body>

        <!-- Message List panel on the left -->
        <div id="message-list-panel">
            <input id="message-list-filter-input" type="text" placeholder="Filter by method or type name" />

            <!-- Filter help popup -->
            <div id="filter-help-popup">
                <strong>Filter Query Syntax</strong>
                <ul>
                    <li><b>Substring match:</b> <code>Foo</code> matches any method or message containing "Foo"</li>
                    <li><b>Key-value filter:</b> <code>method: Foo</code> matches messages with method exactly "Foo"</li>
                    <li><b>Substring key-value:</b> <code>method: ~Foo</code> matches methods containing "Foo"</li>
                    <li><b>Multiple conditions:</b> <code>method: Foo && direction: recv</code> (all conditions must match)</li>
                </ul>
            </div>

            <button id="message-list-clear-button">Clear Messages</button>
            <div id="legend">
                <strong>Legend:</strong>
                <span class="legend-item legend-receive"></span>
                <span>Receive</span>
                <span class="legend-item legend-send"></span>
                <span>Send</span>
                <span class="legend-spacer"></span>
                <input class="legend-item" type="checkbox" id="timezone" />
                <label for="timezone">Show time in UTC</label>
            </div>

            <!-- Container for the messages list -->
            <div id="messages-list-container"></div>

        </div>

        <!-- Resizer between the two panels -->
        <div id="resizer"></div>

        <!-- Message Details panel on the right -->
        <div id="message-details">
            <h3>Message Details</h3>
            <div id="details-content">Select a message to view details</div>
        </div>


        <!-- Templates -->

        <!-- Message list row template -->
        <template id="message-list-template">
            <div class="message-row-content">
                <span class="message-row-message-id"></span>
                <span class="message-row-timestamp"></span>
                <span class="message-row-method-and-message"></span>
            </div>
        </template>

        <!-- Message details template -->
        <template id="message-details-template">
            <div class="message-details-content">
                <div class="message-details-metadata">
                    <div class="message-details-row">
                        <span class="message-details-label">message_id:</span>
                        <span id="message-details-message-id-value"></span>
                    </div>
                    <div id="message-details-stream-id" class="message-details-row hidden">
                        <span class="message-details-label">stream_id:</span>
                        <span id="message-details-stream-id-value"></span>
                    </div>
                    <div class="message-details-row">
                        <span class="message-details-label">time:</span>
                        <span id="message-details-timestamp-value"></span>
                    </div>
                    <div class="message-details-row">
                        <span class="message-details-label">method:</span>
                        <span id="message-details-method-value"></span>
                    </div>
                    <div class="message-details-row">
                        <span class="message-details-label">message:</span>
                        <span id="message-details-message-value"></span>
                    </div>
                    <div class="message-details-row">
                        <span class="message-details-label">direction:</span>
                        <span id="message-details-direction-value"></span>
                    </div>
                    <div class="message-details-row">
                        <span class="message-details-label">peer_address:</span>
                        <span id="message-details-peer-address-value"></span>
                    </div>
                    <div id="message-details-error" class="message-details-row hidden">
                        <span class="message-details-label">error:</span>
                        <span id="message-details-error-value"></span>
                    </div>
                </div>
                <div>
                    <pre id="message-details-payload-value"></pre>
                </div>
            </div>
        </template>

    </body>

</html>
